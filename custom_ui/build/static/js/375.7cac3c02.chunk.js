"use strict";(self.webpackChunkmy_app2=self.webpackChunkmy_app2||[]).push([[375],{5375:(e,s,n)=>{n.r(s),n.d(s,{default:()=>j});var t=n(5043),a=(n(8421),n(5819)),r=n(4196),l=n(8931),o=n(7111),i=n(854);const d=n.n(i)().create({baseURL:"https://bcaa.subhas.dev/"}),c={error:"Y",errorDetails:["Something went wrong!"]},u={headers:{Accept:"application/json"}};var h=n(4282),m=n(579);const g=e=>{let{row:s}=e;const[n,i]=t.useState([]),[g,p]=t.useState(""),[x,j]=t.useState("");t.useEffect((()=>{v()}),[]);const v=()=>{(async e=>{try{const s="action=GET_TOKENS&member_id=".concat(e),n=await d.get("/api/members_to_issues.php?".concat(s),u);return console.log(n.data),n.data}catch(s){console.log(s)}return c})(s.original.member_id).then((e=>{e.result&&i(e.result)}))},b=e=>{(async e=>{try{const s={member_id:e,action:"ISSUE_SINGLE_TOKEN"},n=await d.post("/api/members_to_issues.php",s,u);return console.log(n.data),n.data}catch(s){console.log(s)}return c})(e).then((e=>{"Y"===e.error||(p("Succesfully Issued."),v())}))},_=(e,s)=>{(async(e,s)=>{try{const n={member_id:e,iss_id:s,action:"DELETE_TOKEN"},t=await d.post("/api/members_to_issues.php",n,u);return console.log(t.data),t.data}catch(n){console.log(n)}return c})(e,s).then((e=>{"Y"===e.error||(p("Succesfully Deleted."),v())}))},C=(e,s)=>{(async(e,s)=>{try{const n={member_id:e,iss_id:s,action:"UNDO_TOKEN"},t=await d.post("/api/members_to_issues.php",n,u);return console.log(t.data),t.data}catch(n){console.log(n)}return c})(e,s).then((e=>{"Y"===e.error||(p("Succesfully Undo."),v())}))},w=t.useMemo((()=>[{accessorKey:"iss_id",cell:e=>e.getValue(),header:()=>(0,m.jsx)("span",{children:"ID#"})},{accessorKey:"token_text",cell:e=>e.getValue(),header:()=>(0,m.jsx)("span",{children:"Token"})},{accessorKey:"token_status",header:()=>(0,m.jsx)("span",{children:"Token Status #"})},{accessorKey:"token_status_desc",header:"Status Desc"},{accessorKey:"token_redeem_date",header:"Redeem Date"}]),[]),S=(0,l.N4)({data:n,columns:w,getCoreRowModel:(0,o.HT)()});return(0,m.jsxs)("div",{className:"container",children:[g&&(0,m.jsx)(a.A,{variant:"success",children:g}),x&&(0,m.jsx)(a.A,{variant:"warning",children:x}),(0,m.jsx)("div",{}),(0,m.jsxs)(r.A,{striped:!0,bordered:!0,hover:!0,responsive:!0,size:"sm",children:[(0,m.jsx)("thead",{children:S.getHeaderGroups().map((e=>(0,m.jsx)("tr",{children:e.headers.map((e=>(0,m.jsx)("th",{colSpan:e.colSpan,children:e.isPlaceholder?null:(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{children:(0,l.Kv)(e.column.columnDef.header,e.getContext())})})},e.id)))},e.id)))}),(0,m.jsx)("tbody",{children:S.getRowModel().rows.map((e=>(0,m.jsx)(t.Fragment,{children:(0,m.jsxs)("tr",{children:[(0,m.jsxs)("td",{children:["R"===e.original.token_status&&(0,m.jsx)(h.A,{variant:"danger",onClick:()=>C(e.original.member_id,e.original.iss_id),children:"Undo Redeem"})," "," ",(0,m.jsx)(h.A,{variant:"warning",onClick:()=>_(e.original.member_id,e.original.iss_id),children:"Remove"})]}),e.getVisibleCells().map((e=>(0,m.jsx)("td",{children:(0,l.Kv)(e.column.columnDef.cell,e.getContext())},e.id)))]})},e.id)))})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)(h.A,{variant:"primary",onClick:v,children:"Refresh"})," ",(0,m.jsx)(h.A,{variant:"primary",onClick:()=>b(s.original.member_id),children:"Issue 1 Token"})," ",(0,m.jsx)(h.A,{variant:"info",onClick:()=>{s.original.member_id},children:"Send Email to User"})," ",(0,m.jsx)(h.A,{variant:"info",onClick:()=>{return s.original.member_id,e=s.original.member_email,void window.open("https://bcaa.subhas.dev/custom_pages/members_details.php?email="+e,"_balnk");var e},children:"Open As PDF"})," "]})]})};function p(e){var s,n,t;let{column:a}=e;const r=a.getFilterValue(),{filterVariant:l}=null!==(s=a.columnDef.meta)&&void 0!==s?s:{};return"range"===l?(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{className:"flex space-x-2",children:[(0,m.jsx)(x,{type:"number",value:null!==(n=null===r||void 0===r?void 0:r[0])&&void 0!==n?n:"",onChange:e=>a.setFilterValue((s=>[e,null===s||void 0===s?void 0:s[1]])),placeholder:"Min",className:"w-24 border shadow rounded"}),(0,m.jsx)(x,{type:"number",value:null!==(t=null===r||void 0===r?void 0:r[1])&&void 0!==t?t:"",onChange:e=>a.setFilterValue((s=>[null===s||void 0===s?void 0:s[0],e])),placeholder:"Max",className:"w-24 border shadow rounded"})]}),(0,m.jsx)("div",{className:"h-1"})]}):"select"===l?(0,m.jsxs)("select",{onChange:e=>a.setFilterValue(e.target.value),value:null===r||void 0===r?void 0:r.toString(),children:[(0,m.jsx)("option",{value:"",children:"All"}),(0,m.jsx)("option",{value:"1",children:"Active Only"})]}):(0,m.jsx)(x,{className:"w-36 border shadow rounded",onChange:e=>a.setFilterValue(e),placeholder:"Search...",type:"text",value:null!==r&&void 0!==r?r:""})}function x(e){let{value:s,onChange:n,debounce:a=500,...r}=e;const[l,o]=t.useState(s);return t.useEffect((()=>{o(s)}),[s]),t.useEffect((()=>{const e=setTimeout((()=>{n(l)}),a);return()=>clearTimeout(e)}),[l]),(0,m.jsx)("input",{...r,value:l,onChange:e=>o(e.target.value)})}const j=()=>{const e=t.useReducer((()=>({})),{})[1],[s,n]=t.useState([]),a=t.useMemo((()=>[{accessorKey:"member_name",cell:e=>{let{row:s,getValue:n}=e;return(0,m.jsx)("div",{style:{paddingLeft:"".concat(2*s.depth,"rem")},children:(0,m.jsxs)("div",{children:[s.getCanExpand()?(0,m.jsx)("button",{onClick:s.getToggleExpandedHandler(),style:{cursor:"pointer"},children:s.getIsExpanded()?"\ud83d\udc47":"\ud83d\udc49"}):"\ud83d\udd35"," ",n()]})})},header:()=>(0,m.jsx)("span",{children:"Name"})},{accessorFn:e=>e.member_email,id:"member_email",cell:e=>e.getValue(),header:()=>(0,m.jsx)("span",{children:"Email"})},{accessorKey:"token_count",header:()=>(0,m.jsx)("span",{children:"Token Count #"})},{accessorKey:"member_status_desc",header:"Status",meta:{filterVariant:"select"}}]),[]),[i,c]=t.useState([]);t.useEffect((()=>{(async()=>{try{const e=await d.get("/api/members_to_issues.php",u);return console.log(e.data),e.data}catch(e){console.log(e)}return{error:"Y"}})().then((e=>{e.result&&c(e.result)}))}),[]);const h=(0,l.N4)({data:i,columns:a,filterFns:{},state:{columnFilters:s},getRowCanExpand:()=>!0,onColumnFiltersChange:n,getCoreRowModel:(0,o.HT)(),getFilteredRowModel:(0,o.hM)(),getSortedRowModel:(0,o.h5)(),getPaginationRowModel:(0,o.kW)(),debugTable:!0,debugHeaders:!0,debugColumns:!1});return(0,m.jsxs)("div",{className:"p-2",children:[(0,m.jsxs)(r.A,{striped:!0,bordered:!0,hover:!0,responsive:!0,size:"sm",children:[(0,m.jsx)("thead",{children:h.getHeaderGroups().map((e=>(0,m.jsx)("tr",{children:e.headers.map((e=>{var s;return(0,m.jsx)("th",{colSpan:e.colSpan,children:e.isPlaceholder?null:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:e.column.getCanSort()?"cursor-pointer select-none":"",onClick:e.column.getToggleSortingHandler(),children:[(0,l.Kv)(e.column.columnDef.header,e.getContext()),null!==(s={asc:" \ud83d\udd3c",desc:" \ud83d\udd3d"}[e.column.getIsSorted()])&&void 0!==s?s:null]}),e.column.getCanFilter()?(0,m.jsx)("div",{children:(0,m.jsx)(p,{column:e.column})}):null]})},e.id)}))},e.id)))}),(0,m.jsx)("tbody",{children:h.getRowModel().rows.map((e=>(0,m.jsxs)(t.Fragment,{children:[(0,m.jsx)("tr",{children:e.getVisibleCells().map((e=>(0,m.jsx)("td",{children:(0,l.Kv)(e.column.columnDef.cell,e.getContext())},e.id)))}),e.getIsExpanded()&&(0,m.jsx)("tr",{children:(0,m.jsx)("td",{colSpan:e.getVisibleCells().length,children:(0,m.jsx)(g,{row:e})})})]},e.id)))})]}),(0,m.jsx)("div",{className:"h-2"}),(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)("button",{className:"border rounded p-1",onClick:()=>h.setPageIndex(0),disabled:!h.getCanPreviousPage(),children:"<<"}),(0,m.jsx)("button",{className:"border rounded p-1",onClick:()=>h.previousPage(),disabled:!h.getCanPreviousPage(),children:"<"}),(0,m.jsx)("button",{className:"border rounded p-1",onClick:()=>h.nextPage(),disabled:!h.getCanNextPage(),children:">"}),(0,m.jsx)("button",{className:"border rounded p-1",onClick:()=>h.setPageIndex(h.getPageCount()-1),disabled:!h.getCanNextPage(),children:">>"}),(0,m.jsxs)("span",{className:"flex items-center gap-1",children:[(0,m.jsx)("div",{children:"Page"}),(0,m.jsxs)("strong",{children:[h.getState().pagination.pageIndex+1," of"," ",h.getPageCount()]})]}),(0,m.jsxs)("span",{className:"flex items-center gap-1",children:["| Go to page:",(0,m.jsx)("input",{type:"number",defaultValue:h.getState().pagination.pageIndex+1,onChange:e=>{const s=e.target.value?Number(e.target.value)-1:0;h.setPageIndex(s)},className:"border p-1 rounded w-16"})]}),(0,m.jsx)("select",{value:h.getState().pagination.pageSize,onChange:e=>{h.setPageSize(Number(e.target.value))},children:[10,20,30,40,50,100,200].map((e=>(0,m.jsxs)("option",{value:e,children:["Show ",e]},e)))})]}),(0,m.jsxs)("div",{children:[h.getPrePaginationRowModel().rows.length," Rows"]}),(0,m.jsx)("div",{children:(0,m.jsx)("button",{onClick:()=>e(),children:"Force Rerender"})}),(0,m.jsx)("div",{children:(0,m.jsx)("button",{onClick:()=>c((e=>[])),children:"Refresh Data"})}),(0,m.jsx)("pre",{children:JSON.stringify({columnFilters:h.getState().columnFilters},null,2)})]})}}}]);
//# sourceMappingURL=375.7cac3c02.chunk.js.map