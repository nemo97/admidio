"use strict";(self.webpackChunkmy_app2=self.webpackChunkmy_app2||[]).push([[375],{5375:(e,t,n)=>{n.r(t),n.d(t,{default:()=>C});var r=n(5043),s=(n(8421),n(1356)),a=n(8258),o=n(5296),l=n(5361),i=n(4196),c=n(8931),d=n(7111),u=n(854);const h=n.n(u)().create({baseURL:"https://bcaa.subhas.dev/"}),g={error:"Y",errorDetails:["Something went wrong!"]},m={headers:{Accept:"application/json"}};var p=n(4282),x=n(4277),v=n.n(x),j=n(579);const b=e=>{let{updateParentCurrentEvent:t}=e;const[n,i]=r.useState(""),[c,d]=r.useState(""),[u,x]=r.useState([]),[v,b]=r.useState(0);r.useEffect((()=>{_()}),[]),r.useEffect((()=>{const e=u.filter((e=>"Y"===e.status))[0];e?(b(e.event_id),t(e.event_id)):(b(-1),t(-1))}),[u]);const _=()=>{(async()=>{const e={error:"Y"};try{const e="action=GET_EVENTS",t=await h.get("/api/members_to_issues.php?".concat(e),m);return console.log(t.data),t.data}catch(t){let n="";"string"===typeof t?n=t.toUpperCase():t instanceof Error&&(n=t.message),e.errorDetails=[n]}return e})().then((e=>{e.result&&x(e.result)}))},S=u.map((e=>(0,j.jsx)("option",{value:e.event_id,children:e.event_id+" - "+e.description}))),y=()=>{window.confirm("Reaaly want to change current event?")&&(async e=>{let t=g;try{const t={event_id:e,action:"SET_EVENT"},n=await h.post("/api/members_to_issues.php",t,m);return console.log(n.data),n.data}catch(n){let e="";"string"===typeof n?e=n.toUpperCase():n instanceof Error&&(e=n.message),console.log(n),t.errorDetails=[e]}return t})(v).then((e=>{"Y"===e.error?(e.errorDetails&&(i(""),d(e.errorDetails.join(" , "))),b(-1),t(-1)):(i("Succesfully changed event."),t(v))}))};return(0,j.jsxs)("div",{className:"container",children:[n&&(0,j.jsx)(s.A,{variant:"success",children:n}),c&&(0,j.jsx)(s.A,{variant:"warning",children:c}),(0,j.jsx)("div",{}),(0,j.jsx)("div",{children:(0,j.jsx)(a.A,{children:(0,j.jsx)(a.A.Body,{children:(0,j.jsxs)(o.A,{controlId:"floatingSelect",label:"Current Event",children:[(0,j.jsx)(l.A.Select,{value:v,onChange:e=>{b(Number(e.target.value))},"aria-label":"Current Event",children:S}),(0,j.jsx)(p.A,{variant:"danger",onClick:()=>y(),children:"Update"})]})})})})]})},_=e=>{let{row:t}=e;const[n,a]=r.useState([]),[o,l]=r.useState(""),[u,x]=r.useState(""),[v,b]=r.useState([]);r.useEffect((()=>{_()}),[]);const _=()=>{(async e=>{try{const t="action=GET_TOKENS&member_id=".concat(e),n=await h.get("/api/members_to_issues.php?".concat(t),m);return console.log(n.data),n.data}catch(t){console.log(t)}return g})(t.original.member_id).then((e=>{e.result&&a(e.result)}))},S=e=>{(async e=>{try{const t={member_id:e,action:"ISSUE_SINGLE_TOKEN"},n=await h.post("/api/members_to_issues.php",t,m);return console.log(n.data),n.data}catch(t){console.log(t)}return g})(e).then((e=>{"Y"===e.error?e.errorDetails&&(l(""),x(e.errorDetails.join(" , "))):(l("Succesfully Issued."),_())}))},y=e=>{(async e=>{try{const t={member_id:e,action:"SEND_SINGLE_EMAIL"},n=await h.post("/api/members_to_issues.php",t,m);return console.log(n.data),n.data}catch(t){throw console.log(t),t}return g})(e).then((e=>{"Y"===e.error?e.errorDetails&&(l(""),x(e.errorDetails.join(" , "))):(l("Succesfully Sent Email."),_())}))},C=(e,t)=>{window.confirm("Really, want to delete? Deleting this invalidate sent qrcode.")&&(async(e,t)=>{try{const n={member_id:e,iss_id:t,action:"DELETE_TOKEN"},r=await h.post("/api/members_to_issues.php",n,m);return console.log(r.data),r.data}catch(n){console.log(n)}return g})(e,t).then((e=>{"Y"===e.error?e.errorDetails&&(l(""),x(e.errorDetails.join(" , "))):(l("Succesfully Deleted."),_())}))},w=(e,t)=>{window.confirm("Really, want to undo?")&&(async(e,t)=>{try{const n={member_id:e,redeem_id:t,action:"UNDO_TOKEN"},r=await h.post("/api/members_to_issues.php",n,m);return console.log(r.data),r.data}catch(n){console.log(n)}return g})(e,t).then((e=>{"Y"===e.error?e.errorDetails&&(l(""),x(e.errorDetails.join(" , "))):(l("Succesfully Undo."),_())}))},f=r.useMemo((()=>[{accessorKey:"iss_id",cell:e=>e.getValue(),header:()=>(0,j.jsx)("span",{children:"ID#"})},{accessorKey:"token_text",cell:e=>e.getValue(),header:()=>(0,j.jsx)("span",{children:"Token"})},{accessorKey:"sent_status",cell:e=>e.getValue(),header:()=>(0,j.jsx)("span",{children:"Email Sent?"})},{accessorKey:"sent_date",cell:e=>e.getValue(),header:()=>(0,j.jsx)("span",{children:"Email Date"})},{accessorKey:"status",header:()=>(0,j.jsx)("span",{children:"Redeem Status"})},{accessorKey:"event_id",header:()=>(0,j.jsx)("span",{children:"Event Id"})},{accessorKey:"token_redeem_date",header:()=>(0,j.jsx)("span",{children:"Redeem Date"})}]),[]),E=(0,c.N4)({data:n,columns:f,state:{sorting:v},getCoreRowModel:(0,d.HT)(),getSortedRowModel:(0,d.h5)(),getPaginationRowModel:(0,d.kW)(),onSortingChange:b});return(0,j.jsxs)("div",{className:"container",children:[o&&(0,j.jsx)(s.A,{variant:"success",children:o}),u&&(0,j.jsx)(s.A,{variant:"warning",children:u}),(0,j.jsx)("div",{}),(0,j.jsxs)(i.A,{striped:!0,bordered:!0,hover:!0,responsive:!0,size:"sm",children:[(0,j.jsx)("thead",{children:E.getHeaderGroups().map((e=>(0,j.jsxs)("tr",{children:[(0,j.jsx)("th",{children:"\xa0"}),e.headers.map((e=>{var t;return(0,j.jsx)("th",{colSpan:e.colSpan,children:e.isPlaceholder?null:(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)("div",{className:e.column.getCanSort()?"cursor-pointer select-none":"",onClick:e.column.getToggleSortingHandler(),title:e.column.getCanSort()?"asc"===e.column.getNextSortingOrder()?"Sort ascending":"desc"===e.column.getNextSortingOrder()?"Sort descending":"Clear sort":void 0,children:[(0,c.Kv)(e.column.columnDef.header,e.getContext()),null!==(t={asc:" \ud83d\udd3c",desc:" \ud83d\udd3d"}[e.column.getIsSorted()])&&void 0!==t?t:null]})})},e.id)}))]},e.id)))}),(0,j.jsx)("tbody",{children:E.getRowModel().rows.map((e=>(0,j.jsx)(r.Fragment,{children:(0,j.jsxs)("tr",{children:[(0,j.jsxs)("td",{children:["R"===e.original.status&&(0,j.jsx)(p.A,{variant:"danger",onClick:()=>w(e.original.member_id,e.original.redeem_id),children:"Undo Redeem"})," "," ",(0,j.jsx)(p.A,{variant:"warning",onClick:()=>C(e.original.member_id,e.original.iss_id),children:"Remove"})]}),e.getVisibleCells().map((e=>(0,j.jsx)("td",{children:(0,c.Kv)(e.column.columnDef.cell,e.getContext())},e.id)))]})},e.id)))})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)(p.A,{variant:"primary",onClick:_,children:"Refresh"})," ",(0,j.jsx)(p.A,{variant:"primary",onClick:()=>S(t.original.member_id),children:"Issue 1 Token"})," ",(0,j.jsx)(p.A,{variant:"info",onClick:()=>y(t.original.member_id),children:"Send Email to User"})," ",(0,j.jsx)(p.A,{variant:"info",onClick:()=>{return t.original.member_id,e=t.original.member_email,n=t.original.mem_uuid,void window.open("https://bcaa.subhas.dev/custom_pages/members_details.php?email="+e+"&id="+n,"_balnk");var e,n},children:"Open As PDF"})," "]})]})};function S(e){var t,n,r;let{column:s}=e;const a=s.getFilterValue(),{filterVariant:o}=null!==(t=s.columnDef.meta)&&void 0!==t?t:{};return"range"===o?(0,j.jsxs)("div",{children:[(0,j.jsxs)("div",{className:"flex space-x-2",children:[(0,j.jsx)(y,{type:"number",value:null!==(n=null===a||void 0===a?void 0:a[0])&&void 0!==n?n:"",onChange:e=>s.setFilterValue((t=>[e,null===t||void 0===t?void 0:t[1]])),placeholder:"Min",className:"w-24 border shadow rounded"}),(0,j.jsx)(y,{type:"number",value:null!==(r=null===a||void 0===a?void 0:a[1])&&void 0!==r?r:"",onChange:e=>s.setFilterValue((t=>[null===t||void 0===t?void 0:t[0],e])),placeholder:"Max",className:"w-24 border shadow rounded"})]}),(0,j.jsx)("div",{className:"h-1"})]}):"select"===o?(0,j.jsxs)("select",{onChange:e=>s.setFilterValue(e.target.value),value:null===a||void 0===a?void 0:a.toString(),children:[(0,j.jsx)("option",{value:"",children:"All"}),(0,j.jsx)("option",{value:"1",children:"Active Only"})]}):(0,j.jsx)(y,{className:"w-36 border shadow rounded",onChange:e=>s.setFilterValue(e),placeholder:"Search...",type:"text",value:null!==a&&void 0!==a?a:""})}function y(e){let{value:t,onChange:n,debounce:s=500,...a}=e;const[o,l]=r.useState(t);return r.useEffect((()=>{l(t)}),[t]),r.useEffect((()=>{const e=setTimeout((()=>{n(o)}),s);return()=>clearTimeout(e)}),[o]),(0,j.jsx)("input",{...a,value:o,onChange:e=>l(e.target.value)})}const C=()=>{r.useReducer((()=>({})),{})[1];const[e,t]=r.useState(0),[n,a]=r.useState([]),o=r.useMemo((()=>[{accessorKey:"member_name",cell:e=>{let{row:t,getValue:n}=e;return(0,j.jsx)("div",{style:{paddingLeft:"".concat(2*t.depth,"rem")},children:(0,j.jsxs)("div",{children:[t.getCanExpand()?(0,j.jsx)("button",{onClick:t.getToggleExpandedHandler(),style:{cursor:"pointer"},children:t.getIsExpanded()?"\ud83d\udc47":"\ud83d\udc49"}):"\ud83d\udd35"," ",n()]})})},header:()=>(0,j.jsx)("span",{children:"Name"})},{accessorFn:e=>e.member_email,id:"member_email",cell:e=>e.getValue(),header:()=>(0,j.jsx)("span",{children:"Email"})},{accessorKey:"guest_count",header:()=>(0,j.jsx)("span",{children:"Guest Count #"})},{accessorKey:"token_count",header:()=>(0,j.jsx)("span",{children:"Token Count(Redeem Count)"})},{accessorKey:"member_status_desc",header:"Status",meta:{filterVariant:"select"}},{accessorKey:"sent_status",header:()=>(0,j.jsx)("span",{children:"Email Sent Status"})},{accessorKey:"sent_date",header:()=>(0,j.jsx)("span",{children:"Sent Date"})}]),[]),[l,u]=r.useState([]),[p,x]=r.useState(""),[y,C]=r.useState(""),[w,f]=r.useState(!0),[E,N]=r.useState([]);r.useEffect((()=>{A()}),[]);const D=()=>{f(!0),(async()=>{try{const e={action:"send_email_active_members"},t=await h.post("/api/members_to_issues.php",e,m);return console.log(t.data),t.data}catch(e){throw console.log(e),e}return g})().then((e=>{"Y"===e.error?e.errorDetails&&(x(""),C(e.errorDetails.join(" , "))):(x("Succesfully sent emails."),A()),f(!1)})).catch((e=>{C("Error "+e),f(!1)}))},k=()=>{f(!0),(async()=>{try{const e={action:"issue_all_active_members"},t=await h.post("/api/members_to_issues.php",e,m);return console.log(t.data),t.data}catch(e){throw console.log(e),e}return g})().then((e=>{"Y"===e.error?e.errorDetails&&(x(""),C(e.errorDetails.join(" , "))):(x("Succesfully issued tokens."),A()),f(!1)})).catch((e=>{C("Error "+e),f(!1)}))},A=()=>{f(!0),(async()=>{try{const e=await h.get("/api/members_to_issues.php",m);return console.log(e.data),e.data}catch(e){console.log(e)}return{error:"Y"}})().then((e=>{e.result&&u(e.result),f(!1)})).catch((e=>{C("Error "+e),f(!1)}))},R=(0,c.N4)({data:l,columns:o,filterFns:{},state:{columnFilters:n,sorting:E},getRowCanExpand:()=>!0,onColumnFiltersChange:a,getCoreRowModel:(0,d.HT)(),getFilteredRowModel:(0,d.hM)(),getSortedRowModel:(0,d.h5)(),getPaginationRowModel:(0,d.kW)(),onSortingChange:N,debugTable:!0,debugHeaders:!0,debugColumns:!1});return(0,j.jsxs)("div",{className:"p-2",children:[w&&(0,j.jsx)(v(),{type:"spinningBubbles",color:"#0000FF",height:100,width:50}),p&&(0,j.jsx)(s.A,{variant:"success",children:p}),y&&(0,j.jsx)(s.A,{variant:"warning",children:y}),(0,j.jsx)("div",{}),(0,j.jsx)(b,{updateParentCurrentEvent:e=>{t(e)}}),(0,j.jsx)("div",{}),(0,j.jsxs)(i.A,{striped:!0,bordered:!0,hover:!0,responsive:!0,size:"sm",children:[(0,j.jsx)("thead",{children:R.getHeaderGroups().map((e=>(0,j.jsx)("tr",{children:e.headers.map((e=>{var t;return(0,j.jsx)("th",{colSpan:e.colSpan,children:e.isPlaceholder?null:(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{className:e.column.getCanSort()?"cursor-pointer select-none":"",onClick:e.column.getToggleSortingHandler(),title:e.column.getCanSort()?"asc"===e.column.getNextSortingOrder()?"Sort ascending":"desc"===e.column.getNextSortingOrder()?"Sort descending":"Clear sort":void 0,children:[(0,c.Kv)(e.column.columnDef.header,e.getContext()),null!==(t={asc:" \ud83d\udd3c",desc:" \ud83d\udd3d"}[e.column.getIsSorted()])&&void 0!==t?t:null]}),e.column.getCanFilter()?(0,j.jsx)("div",{children:(0,j.jsx)(S,{column:e.column})}):null]})},e.id)}))},e.id)))}),(0,j.jsx)("tbody",{children:R.getRowModel().rows.map((e=>(0,j.jsxs)(r.Fragment,{children:[(0,j.jsx)("tr",{children:e.getVisibleCells().map((e=>(0,j.jsx)("td",{children:(0,c.Kv)(e.column.columnDef.cell,e.getContext())},e.id)))}),e.getIsExpanded()&&(0,j.jsx)("tr",{children:(0,j.jsx)("td",{colSpan:e.getVisibleCells().length,children:(0,j.jsx)(_,{row:e})})})]},e.id)))})]}),(0,j.jsx)("div",{className:"h-2"}),(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)("button",{className:"border rounded p-1",onClick:()=>R.setPageIndex(0),disabled:!R.getCanPreviousPage(),children:"<<"}),(0,j.jsx)("button",{className:"border rounded p-1",onClick:()=>R.previousPage(),disabled:!R.getCanPreviousPage(),children:"<"}),(0,j.jsx)("button",{className:"border rounded p-1",onClick:()=>R.nextPage(),disabled:!R.getCanNextPage(),children:">"}),(0,j.jsx)("button",{className:"border rounded p-1",onClick:()=>R.setPageIndex(R.getPageCount()-1),disabled:!R.getCanNextPage(),children:">>"}),(0,j.jsxs)("span",{className:"flex items-center gap-1",children:[(0,j.jsx)("div",{children:"Page"}),(0,j.jsxs)("strong",{children:[R.getState().pagination.pageIndex+1," of"," ",R.getPageCount()]})]}),(0,j.jsxs)("span",{className:"flex items-center gap-1",children:["| Go to page:",(0,j.jsx)("input",{type:"number",defaultValue:R.getState().pagination.pageIndex+1,onChange:e=>{const t=e.target.value?Number(e.target.value)-1:0;R.setPageIndex(t)},className:"border p-1 rounded w-16"})]}),(0,j.jsx)("select",{value:R.getState().pagination.pageSize,onChange:e=>{R.setPageSize(Number(e.target.value))},children:[10,20,30,40,50,100,200].map((e=>(0,j.jsxs)("option",{value:e,children:["Show ",e]},e)))})]}),(0,j.jsxs)("div",{children:[R.getPrePaginationRowModel().rows.length," Rows"]}),(0,j.jsx)("div",{children:(0,j.jsxs)("button",{onClick:()=>A(),type:"button",className:"btn btn-primary",children:["Refresh Data | ",e]})}),(0,j.jsx)("div",{style:{marginTop:"10px"},children:(0,j.jsx)("button",{onClick:()=>k(),type:"button",className:"btn btn-warning",children:"Issue Token ALL Active Members"})}),(0,j.jsx)("div",{style:{marginTop:"10px"},children:(0,j.jsx)("button",{onClick:()=>D(),type:"button",className:"btn btn-danger",children:"Send Emails ALL Active Members"})})]})}}}]);
//# sourceMappingURL=375.89915b59.chunk.js.map